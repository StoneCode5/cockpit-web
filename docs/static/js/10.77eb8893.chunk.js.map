{"version":3,"sources":["components/DashBoard/Container/index.tsx","components/ProgressList/index.tsx","components/DashBoard/withContainer.tsx","components/ProgressList/item.tsx"],"names":["Container","props","children","attr","id","x","y","w","h","deg","opacity","styles","width","height","left","top","transform","style","className","defaultData","label","current","target","defaultConfig","labelStyle","fontSize","color","ratioStyle","max","background","WithContainer","data","config","useState","maxInt","setMaxInt","useEffect","JSON","parse","stringify","sort","obj1","obj2","val1","Number","val2","map","item","index","WrappedComponent","cacheRepeatRequest","ComponentConfig","source","componentData","setComponentData","autoUpdate","api","url","method","staleTime","handleRes","res","appendRequest","RequestThrottle","appendUrl","request","then","code","updateUrlRes","cData","setInterval","requestUrl","getUrlFromUrls","status","subscribe","Date","getTime","startTime","clearInterval","ProgressItemComponent","setCurrent","setTarget","setTimeout","animateValue","curr","margin","length","slice","valueStyle","String","replace"],"mappings":"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","file":"static/js/10.77eb8893.chunk.js","sourcesContent":["import React from 'react';\r\n\r\ninterface Attr {\r\n    x: number;\r\n    y: number;\r\n    w: number;\r\n    h: number;\r\n    deg: number;\r\n    opacity: number;\r\n}\r\n\r\ninterface Props {\r\n    attr: Attr\r\n    id: string\r\n}\r\n\r\nconst Container: React.FC<Props> = (props) => {\r\n  const {children, attr, id} = props;\r\n  const {x , y , w , h, deg, opacity} = attr\r\n\r\n  const styles = {\r\n      width: w || 0,\r\n      height: h || 0,\r\n      left: x || 0,\r\n      top: y ||0 ,\r\n      transform: `rotate(${deg || 0}deg)`,\r\n      opacity: opacity || 1,\r\n  }\r\n  \r\n  return <div style={styles} className=\"absolute\" data-id={id}>\r\n      {children}\r\n  </div>;\r\n};\r\n\r\nexport default Container;","import React, { useState, useEffect } from \"react\";\r\nimport { WithContainer } from \"../DashBoard/withContainer\";\r\nimport \"./index.less\";\r\nimport ProgressItem from \"./item\";\r\n\r\n\r\nconst defaultData = [\r\n    { label: \"深圳\", current: 168, target: 200 },\r\n    { label: \"广东\", current: 118, target: 200  },\r\n    { label: \"广西\", current: 88, target: 200  },\r\n    { label: \"云南\", current: 17, target: 200  },\r\n    { label: \"贵州\", current: 66, target: 200  },\r\n    { label: \"海南\", current: 168, target: 200  },\r\n    { label: \"四川\", current: 118, target: 200  },\r\n    { label: \"上海\", current: 88, target: 200  },\r\n    { label: \"内蒙古\", current: 17, target: 200  },\r\n    { label: \"河南\", current: 66, target: 200  },\r\n    { label: \"江西\", current: 168, target: 200  },\r\n    { label: \"新疆\", current: 168, target: 200  }\r\n];\r\nconst defaultConfig = {\r\n  height: 14,\r\n  width: 300,\r\n  labelStyle: {\r\n    fontSize: 14,\r\n    color: \"#FFFFFF\",\r\n    opacity: 0.4,\r\n    width: 36,\r\n  },\r\n  ratioStyle: {\r\n    max: {\r\n      background: \"rgba(255,255,255, 0.1)\",\r\n      width: 150,\r\n    },\r\n    target:{\r\n        fontSize: '10px',\r\n        color: '#4c87ff'\r\n    },\r\n    current:{\r\n        fontSize: '10px',\r\n        color: '#ff9e0d'\r\n    }\r\n  },\r\n};\r\nconst LoopComponent: React.FC<any> = (props) => {\r\n  const { data = defaultData, config = defaultConfig } = props;\r\n  const [maxInt, setMaxInt] = useState(100);\r\n  useEffect(() => {\r\n    const compare = function (obj1: any, obj2: any) {\r\n      const val1 = Number(obj1.target);\r\n      const val2 = Number(obj2.target);\r\n      if (val1 > val2) {\r\n        return -1;\r\n      } else if (val1 < val2) {\r\n        return 1;\r\n      } else {\r\n        return 0;\r\n      }\r\n    };\r\n    const max = JSON.parse(JSON.stringify(data)).sort(compare)[0].target;\r\n    setMaxInt(max);\r\n  }, [data]);\r\n  return (\r\n    <div className=\"list\">\r\n      {data && data.map((item: any, index: number) => (\r\n        <ProgressItem data={item} config={config} index={index} maxInt={maxInt} key={index}></ProgressItem>\r\n          // <div\r\n          //   key={item.label}\r\n          //   className=\"list-item\"\r\n          //   style={{ \r\n          //     width: `${config.width}px`, \r\n          //     height: `${config.height}px`,\r\n          //     margin: `${index<data.length/2?'0 30px 12px 0':'0  0 12px 0'}`\r\n          //   }}\r\n          // >\r\n          //   <span style={{\r\n          //       fontSize: `${config.labelStyle.fontSize}px`,\r\n          //       color: config.labelStyle.color,\r\n          //       opacity: config.labelStyle.opacity,\r\n          //       width: `${config.labelStyle.width}px`,\r\n          //   }}>{item.label.slice(0, 2)}</span>\r\n          //   <div className=\"list-item-box\" style={{\r\n          //       background: config.ratioStyle.max.background,\r\n          //       width: `${config.ratioStyle.max.width}px`,\r\n          //       height: `${config.height}px`,\r\n          //   }}>\r\n          //     <div\r\n          //       className=\"list-item-box-target\"\r\n          //       style={{\r\n          //         background: config.ratioStyle.target.color,\r\n          //         height: config.height,\r\n          //         width: `${ item.target / maxInt * config.ratioStyle.max.width }px`,\r\n          //       }}\r\n          //     ></div>\r\n          //     <div\r\n          //       className=\"list-item-box-current\"\r\n          //       style={{\r\n          //         background: config.ratioStyle.current.color,\r\n          //         height: config.height,\r\n          //         width: `${ item.current / maxInt * config.ratioStyle.max.width }px`,\r\n          //       }}\r\n          //     ></div>\r\n          //   </div>\r\n          //   <div className=\"list-item-num\" style={{ ...config.valueStyle}}>\r\n          //     <div style={config.ratioStyle.current}>{String(item.current).replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, \"$1,\")}</div>\r\n          //     <div style={config.ratioStyle.target}>{String(item.target).replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, \"$1,\")}</div>\r\n          //   </div>\r\n          // </div>\r\n        ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WithContainer(LoopComponent);\r\n","import React, { useEffect, useState } from \"react\";\r\nimport Container from \"./Container\";\r\nimport request from \"../../utils/request\";\r\nimport { RequestThrottle } from \"./utils\";\r\n\r\ninterface Props {\r\n  config: DashBoard.Layer;\r\n  cacheRepeatRequest: boolean \r\n}\r\n\r\nexport function WithContainer(WrappedComponent: any) {\r\n  const ContainerFC: React.FC<Props> = (props) => {\r\n    const { config, cacheRepeatRequest } = props;\r\n    const {\r\n      config: ComponentConfig,\r\n      attr,\r\n      data,\r\n      data: { source },\r\n      id,\r\n    } = config;\r\n\r\n    const [componentData, setComponentData] = useState(source);\r\n    useEffect(() => {\r\n      // 这一层去改变数据\r\n      const { autoUpdate, api = { url: \"\", method: \"get\", staleTime: 5 * 1000, handleRes: (res:any) => res } } = data;\r\n      const { url, method, staleTime, handleRes } = api;\r\n\r\n      const appendRequest = (RequestThrottle:any) => {\r\n        RequestThrottle.appendUrl(url);\r\n        request[method](url).then((res) => {\r\n          if (res.code === \"00000\") {\r\n            RequestThrottle.updateUrlRes(url, res);\r\n            const cData = handleRes? handleRes(res.data) : res.data\r\n            setComponentData(cData);\r\n          }\r\n        });\r\n      }\r\n\r\n      if (autoUpdate && typeof autoUpdate === \"number\") {\r\n        const id = setInterval(() => {\r\n          if (cacheRepeatRequest) {\r\n            const requestUrl = RequestThrottle.getUrlFromUrls(url);\r\n            // 有正在请求的相同的请求\r\n            if (requestUrl) {\r\n              //请求中\r\n              if (requestUrl.status === \"pendding\") {\r\n                RequestThrottle.subscribe(url, (res: any) => {\r\n                  if (res.code === \"00000\") {\r\n                    const cData = handleRes? handleRes(res.data) : res.data\r\n                    setComponentData(cData);\r\n                  }\r\n                });\r\n              } else {\r\n                // 有请求成功的相同请求\r\n                const cha = new Date().getTime() - requestUrl.startTime;\r\n                // 该请求还未过有效期\r\n                if (cha >= staleTime) {\r\n                  appendRequest(RequestThrottle)\r\n                } else {\r\n                  // 过了有效期 重新发起请求\r\n                  const { res } = requestUrl;\r\n                  if (res.code === \"00000\") {\r\n                    const cData = handleRes? handleRes(res.data) : res.data\r\n                    setComponentData(cData);\r\n                  }\r\n                }\r\n              }\r\n            } else {\r\n              // 之前没有过相同的请求\r\n              appendRequest(RequestThrottle)\r\n            }\r\n          } else {\r\n            request[method](url).then((res) => {\r\n              if (res.code === \"00000\") {\r\n                const cData = handleRes? handleRes(res.data) : res.data\r\n                setComponentData(cData);\r\n              }\r\n            });\r\n          }\r\n        }, autoUpdate);\r\n\r\n        return () => {\r\n          clearInterval(id);\r\n        };\r\n      }\r\n    }, []);\r\n\r\n    return (\r\n      <Container attr={attr} id={id}>\r\n        <WrappedComponent {...ComponentConfig} data={componentData} />\r\n      </Container>\r\n    );\r\n  };\r\n  return ContainerFC;\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport \"./index.less\";\r\nimport { animateValue } from \"../../utils/utils\";\r\n\r\nconst defaultConfig = {\r\n  height: 14,\r\n  width: 300,\r\n  labelStyle: {\r\n    fontSize: 14,\r\n    color: \"#FFFFFF\",\r\n    opacity: 0.4,\r\n    width: 36,\r\n  },\r\n  ratioStyle: {\r\n    max: {\r\n      background: \"rgba(255,255,255, 0.1)\",\r\n      width: 150,\r\n    },\r\n    target: {\r\n      fontSize: \"10px\",\r\n      color: \"#4c87ff\",\r\n    },\r\n    current: {\r\n      fontSize: \"10px\",\r\n      color: \"#ff9e0d\",\r\n    },\r\n  },\r\n};\r\nconst ProgressItemComponent: React.FC<any> = (props) => {\r\n  const {\r\n    data = { label: \"广东\", current: 118, target: 200 },\r\n    config = defaultConfig,\r\n    maxInt = 100,\r\n    index = 0,\r\n  } = props;\r\n  const [current, setCurrent] = useState<number>(0);\r\n  const [target, setTarget] = useState<number>(0);\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      animateValue(current, data.current || 0, 500, (curr) => {\r\n        setCurrent(curr);\r\n      });\r\n      animateValue(target, data.target || 0, 500, (curr) => {\r\n        setTarget(curr);\r\n      });\r\n    }, 1000);\r\n  }, [data]);\r\n  return (\r\n    <div\r\n      key={data.label}\r\n      className=\"list-item\"\r\n      style={{\r\n        width: `${config.width}px`,\r\n        height: `${config.height}px`,\r\n        margin: `${index < data.length / 2 ? \"0 30px 12px 0\" : \"0  0 12px 0\"}`,\r\n      }}\r\n    >\r\n      <span\r\n        style={{\r\n          fontSize: `${config.labelStyle.fontSize}px`,\r\n          color: config.labelStyle.color,\r\n          opacity: config.labelStyle.opacity,\r\n          width: `${config.labelStyle.width}px`,\r\n        }}\r\n      >\r\n        {data.label.slice(0, 2)}\r\n      </span>\r\n      <div\r\n        className=\"list-item-box\"\r\n        style={{\r\n          background: config.ratioStyle.max.background,\r\n          width: `${config.ratioStyle.max.width}px`,\r\n          height: `${config.height}px`,\r\n        }}\r\n      >\r\n        <div\r\n          className=\"list-item-box-target\"\r\n          style={{\r\n            background: config.ratioStyle.target.color,\r\n            height: config.height,\r\n            width: `${(data.target / maxInt) * config.ratioStyle.max.width}px`,\r\n          }}\r\n        ></div>\r\n        <div\r\n          className=\"list-item-box-current\"\r\n          style={{\r\n            background: config.ratioStyle.current.color,\r\n            height: config.height,\r\n            width: `${(data.current / maxInt) * config.ratioStyle.max.width}px`,\r\n          }}\r\n        ></div>\r\n      </div>\r\n      <div className=\"list-item-num\" style={{ ...config.valueStyle }}>\r\n        <div style={config.ratioStyle.current}>{String(current).replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, \"$1,\")}</div>\r\n        <div style={config.ratioStyle.target}>{String(target).replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, \"$1,\")}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProgressItemComponent;\r\n"],"sourceRoot":""}